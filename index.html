<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuantumFX Signals - Advanced Cryptocurrency Trading Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <style>
        /* Custom animations */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }

        /* Glassmorphism effect */
        .backdrop-blur-lg {
            backdrop-filter: blur(16px);
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, #a855f7, #f97316);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(to bottom, #9333ea, #ea580c);
        }

        /* Pulse animation for loading */
        .pulse-subtle {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        /* Background pattern */
        .bg-pattern {
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="min-h-screen bg-gradient-to-br from-purple-900 via-purple-800 to-orange-600">
            <!-- Background Pattern -->
            <div class="absolute inset-0 bg-black/20"></div>
            <div class="absolute inset-0 bg-pattern"></div>
            
            <div class="relative z-10 p-4 md:p-6">
                <div class="max-w-7xl mx-auto">
                    <!-- Header -->
                    <div class="text-center mb-8">
                        <div class="flex items-center justify-center mb-4">
                            <div class="bg-gradient-to-r from-purple-400 to-orange-400 p-3 rounded-2xl mr-4">
                                <i data-lucide="zap" class="w-8 h-8 text-white"></i>
                            </div>
                            <h1 class="text-4xl md:text-6xl font-bold bg-gradient-to-r from-white via-purple-200 to-orange-200 bg-clip-text text-transparent">
                                QuantumFX Signals
                            </h1>
                        </div>
                        <p class="text-purple-200 text-lg md:text-xl max-w-2xl mx-auto">
                            Advanced cryptocurrency trading signals powered by quantum algorithms
                        </p>
                    </div>

                    <!-- Stats Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                        <!-- Total Signals -->
                        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-purple-200 text-sm font-medium">Total Signals</p>
                                    <p class="text-3xl font-bold text-white">{{ totalSignals }}</p>
                                </div>
                                <i data-lucide="activity" class="w-8 h-8 text-purple-300"></i>
                            </div>
                        </div>

                        <!-- Buy Signals -->
                        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-purple-200 text-sm font-medium">Buy Signals</p>
                                    <p class="text-3xl font-bold text-green-400">{{ buySignals.length }}</p>
                                </div>
                                <i data-lucide="trending-up" class="w-8 h-8 text-green-400"></i>
                            </div>
                        </div>

                        <!-- Sell Signals -->
                        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-purple-200 text-sm font-medium">Sell Signals</p>
                                    <p class="text-3xl font-bold text-red-400">{{ sellSignals.length }}</p>
                                </div>
                                <i data-lucide="trending-down" class="w-8 h-8 text-red-400"></i>
                            </div>
                        </div>

                        <!-- Connection Status -->
                        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-purple-200 text-sm font-medium">Status</p>
                                    <p :class="isConnected ? 'text-green-400' : 'text-red-400'" class="text-lg font-bold">
                                        {{ isConnected ? 'Connected' : 'Offline' }}
                                    </p>
                                </div>
                                <i :data-lucide="isConnected ? 'wifi' : 'wifi-off'" 
                                   :class="isConnected ? 'text-green-400' : 'text-red-400'" 
                                   class="w-8 h-8"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Control Panel -->
                    <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20 mb-8">
                        <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                            <div class="flex items-center gap-4">
                                <button
                                    @click="refreshSignals"
                                    :disabled="isLoading"
                                    class="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-500 to-orange-500 text-white rounded-xl hover:from-purple-600 hover:to-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 shadow-lg hover:shadow-xl"
                                >
                                    <i data-lucide="refresh-cw" :class="isLoading ? 'animate-spin' : ''" class="w-5 h-5"></i>
                                    {{ isLoading ? 'Updating...' : 'Refresh Now' }}
                                </button>
                                
                                <div class="text-purple-200">
                                    <p class="text-sm">Next update in: <span class="font-mono font-bold text-white">{{ nextUpdate }}s</span></p>
                                </div>
                            </div>

                            <div v-if="lastUpdated" class="flex items-center gap-2 text-purple-200">
                                <i data-lucide="clock" class="w-4 h-4"></i>
                                <span class="text-sm">Last updated: {{ formatTime(lastUpdated) }}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Error Message -->
                    <div v-if="error" class="bg-red-500/20 backdrop-blur-lg border border-red-500/30 rounded-2xl p-6 mb-8">
                        <div class="flex items-center gap-3">
                            <i data-lucide="wifi-off" class="w-6 h-6 text-red-400"></i>
                            <div>
                                <h3 class="text-red-400 font-semibold">Connection Error</h3>
                                <p class="text-red-300 mt-1">{{ error }}</p>
                            </div>
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div v-if="isLoading && signals.length === 0" class="text-center py-16">
                        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-12 border border-white/20 inline-block">
                            <i data-lucide="refresh-cw" class="w-12 h-12 animate-spin text-purple-300 mx-auto mb-4"></i>
                            <p class="text-purple-200 text-lg">Loading quantum signals...</p>
                        </div>
                    </div>

                    <!-- No Signals -->
                    <div v-else-if="!isLoading && signals.length === 0" class="text-center py-16">
                        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-12 border border-white/20 inline-block">
                            <i data-lucide="bar-chart-3" class="w-16 h-16 text-purple-300 mx-auto mb-4"></i>
                            <h3 class="text-white text-xl font-semibold mb-2">No Signals Available</h3>
                            <p class="text-purple-200">Waiting for quantum analysis to generate trading signals...</p>
                        </div>
                    </div>

                    <!-- Signals Grid -->
                    <div v-else class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                        <div
                            v-for="signal in signals"
                            :key="`${signal.symbol}-${signal.timestamp}`"
                            class="group bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20 hover:bg-white/20 transition-all duration-300 hover:scale-105 hover:shadow-2xl relative overflow-hidden"
                        >
                            <!-- Signal Header -->
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 rounded-full bg-gradient-to-r from-purple-400 to-orange-400 animate-pulse"></div>
                                    <h3 class="text-xl font-bold text-white">{{ signal.symbol }}</h3>
                                </div>
                                <div :class="getSignalClasses(signal.signal)" class="px-3 py-1 rounded-full flex items-center gap-2 shadow-lg">
                                    <i :data-lucide="getSignalIcon(signal.signal)" class="w-4 h-4"></i>
                                    <span class="font-bold text-sm uppercase">{{ signal.signal }}</span>
                                </div>
                            </div>

                            <!-- Signal Details -->
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-purple-200 text-sm">Source:</span>
                                    <span class="text-white font-medium capitalize">{{ signal.source.replace('_', ' ') }}</span>
                                </div>
                                
                                <div class="flex justify-between items-center">
                                    <span class="text-purple-200 text-sm">Time:</span>
                                    <span class="text-white text-sm">{{ getRelativeTime(signal.timestamp) }}</span>
                                </div>
                                
                                <div class="pt-3 border-t border-white/10">
                                    <div class="flex items-center gap-2 text-xs text-purple-300">
                                        <i data-lucide="clock" class="w-3 h-3"></i>
                                        {{ formatTime(signal.timestamp) }}
                                    </div>
                                </div>
                            </div>

                            <!-- Hover Effect -->
                            <div class="absolute inset-0 bg-gradient-to-r from-purple-500/0 to-orange-500/0 group-hover:from-purple-500/10 group-hover:to-orange-500/10 rounded-2xl transition-all duration-300"></div>
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="text-center mt-12 pt-8 border-t border-white/10">
                        <p class="text-purple-300 text-sm">
                            Powered by QuantumFX • Real-time cryptocurrency trading signals • Updates every minute
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, computed, onMounted, onUnmounted } = Vue;

        createApp({
            setup() {
                // Reactive state
                const signals = ref([]);
                const isLoading = ref(false);
                const isConnected = ref(true);
                const lastUpdated = ref(null);
                const error = ref(null);
                const nextUpdate = ref(60);

                // API configuration
                const API_BASE_URL = 'http://localhost:5000'; // Your Flask backend URL
                const POLL_INTERVAL = 60000; // 1 minute

                let pollInterval = null;
                let countdownInterval = null;

                // Computed properties
                const buySignals = computed(() => signals.value.filter(s => s.signal === 'buy'));
                const sellSignals = computed(() => signals.value.filter(s => s.signal === 'sell'));
                const totalSignals = computed(() => signals.value.length);

                // Fetch signals from API
                const fetchSignals = async () => {
                    try {
                        isLoading.value = true;
                        error.value = null;
                        
                        const response = await fetch(`${API_BASE_URL}/signals`);
                        
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        
                        const data = await response.json();
                        signals.value = data || [];
                        lastUpdated.value = new Date();
                        isConnected.value = true;
                        nextUpdate.value = 60;
                        
                        // Re-initialize Lucide icons for new elements
                        setTimeout(() => {
                            lucide.createIcons();
                        }, 100);
                        
                    } catch (err) {
                        console.error('Error fetching signals:', err);
                        error.value = err.message;
                        isConnected.value = false;
                    } finally {
                        isLoading.value = false;
                    }
                };

                // Manual refresh
                const refreshSignals = () => {
                    fetchSignals();
                };

                // Format timestamp
                const formatTime = (timestamp) => {
                    return new Date(timestamp).toLocaleTimeString('en-US', {
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit'
                    });
                };

                // Format relative time
                const getRelativeTime = (timestamp) => {
                    const now = new Date();
                    const signalTime = new Date(timestamp);
                    const diffInMinutes = Math.floor((now - signalTime) / (1000 * 60));
                    
                    if (diffInMinutes < 1) return 'Just now';
                    if (diffInMinutes === 1) return '1 minute ago';
                    if (diffInMinutes < 60) return `${diffInMinutes} minutes ago`;
                    
                    const diffInHours = Math.floor(diffInMinutes / 60);
                    if (diffInHours === 1) return '1 hour ago';
                    return `${diffInHours} hours ago`;
                };

                // Get signal classes
                const getSignalClasses = (signal) => {
                    return signal === 'buy' 
                        ? 'bg-gradient-to-r from-green-400 to-emerald-500 text-white'
                        : 'bg-gradient-to-r from-red-400 to-rose-500 text-white';
                };

                // Get signal icon
                const getSignalIcon = (signal) => {
                    return signal === 'buy' ? 'trending-up' : 'trending-down';
                };

                // Countdown timer
                const startCountdown = () => {
                    countdownInterval = setInterval(() => {
                        if (nextUpdate.value > 0) {
                            nextUpdate.value--;
                        } else {
                            nextUpdate.value = 60;
                        }
                    }, 1000);
                };

                // Lifecycle hooks
                onMounted(() => {
                    // Initialize Lucide icons
                    lucide.createIcons();
                    
                    // Fetch initial data
                    fetchSignals();
                    
                    // Set up intervals
                    pollInterval = setInterval(fetchSignals, POLL_INTERVAL);
                    startCountdown();
                });

                onUnmounted(() => {
                    if (pollInterval) clearInterval(pollInterval);
                    if (countdownInterval) clearInterval(countdownInterval);
                });

                return {
                    signals,
                    isLoading,
                    isConnected,
                    lastUpdated,
                    error,
                    nextUpdate,
                    buySignals,
                    sellSignals,
                    totalSignals,
                    refreshSignals,
                    formatTime,
                    getRelativeTime,
                    getSignalClasses,
                    getSignalIcon
                };
            }
        }).mount('#app');
    </script>
</body>
</html>